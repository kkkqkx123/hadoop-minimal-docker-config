以下是将您提供的实验内容及要求转换为标准 Markdown（Markdown）格式的文档：

```markdown
# 上机实验内容及要求

## 实验要求
使用常用的 RDD 算子进行 PySpark 编程，深入了解 Spark 中的数据抽象 RDD 的使用。

## 实验平台
- Hadoop 3.3.4
- PySpark

---

## 实验内容

### 一、PySpark 中 RDD 算子的使用

某电商平台记录了用户的点击、加购、下单等行为。每条日志格式如下（用元组表示）：

```
(user_id, item_id, behavior, timestamp)
```

其中字段含义如下：

| 字段       | 说明 |
|------------|------|
| `user_id`     | 用户 ID（整数） |
| `item_id`     | 商品 ID（整数） |
| `behavior`    | 行为类型，取值为 `"click"`、`"cart"`（加入购物车）、`"buy"`（购买） |
| `timestamp`   | 时间戳（毫秒级整数） |

---

### 任务

使用 Spark Core 的 RDD 算子完成以下分析：

#### 1. 计算每个用户“从点击到购买”的转化率（仅考虑同商品）

**定义：**  
对于每个用户 `u` 和每个商品 `i`，如果 `u` 曾点击过 `i`，且后续（时间戳更大）购买了 `i`，则视为一次“成功转化”。

**转化率公式：**  
> 转化率 = （该用户有“点击→购买”路径的商品数） / （该用户点击过的不同商品总数）

**输出要求：**  
- 输出结果格式为 `(user_id, conversion_rate)`。
- 保留 **2 位小数**。
- 若用户无点击行为，则其转化率为 `0.0`。

---

#### 2. 统计每个用户的“加购后购买率”（Cart-to-Buy Conversion Rate）

**定义：**  
对每个用户，计算其加入购物车的商品中，最终完成购买的比例（仅考虑同商品，且 `cart` 时间 < `buy` 时间）。

**说明：**  
这是电商中非常重要的指标，用于衡量购物车流失情况。

**输出要求：**  
- 输出每个用户的加购后购买率 `(user_id, cart_to_buy_rate)`。
- 保留 2 位小数。
- 若用户无加购行为，则该比率记为 `0.0`。

---

#### 3. 识别“高曝光低加购”商品（High-Click Low-Cart Items）

**目标：**  
找出那些被大量用户点击，但极少被加入购物车的商品，可用于诊断商品详情页、价格、库存或主图等问题。

**任务步骤：**

对每个商品 `item_id`，计算：
- 总点击次数（`click_count`）
- 总加购次数（`cart_count`）
- 加购转化率 = `cart_count / click_count`

**筛选条件：**
- `MIN_CLICKS = 10`      # 至少被点击 10 次
- `MAX_CART_RATE = 0.2`  # 加购转化率 ≤ 20%

**输出要求：**  
- 输出满足上述条件的商品列表，格式为 `(item_id, click_count, cart_count, cart_conversion_rate)`。
- `cart_conversion_rate` 保留 2 位小数。
```

---

✅ **说明：** 本实验需使用 **RDD 原生算子**（如 `map`, `filter`, `groupByKey`, `reduceByKey`, `sortBy`, 等），不得使用 DataFrame 或 SQL API。