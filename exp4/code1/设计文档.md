# 任务1设计文档：用户点击到购买转化率计算

## 任务描述
计算每个用户"从点击到购买"的转化率，仅考虑同商品的情况。

## 数据格式
输入数据格式：(user_id, item_id, behavior, timestamp)
- user_id: 用户ID（整数）
- item_id: 商品ID（整数）
- behavior: 行为类型（"click", "cart", "buy"）
- timestamp: 时间戳（毫秒级整数）

## 设计思路

### 1. 数据预处理
- 过滤出所有click和buy行为的数据
- 将数据映射为(user_id, item_id)为key，(behavior, timestamp)为value的格式

### 2. 计算逻辑
对于每个用户-商品组合：
- 检查是否存在click行为且存在buy行为
- 确保buy行为的时间戳大于click行为的时间戳
- 如果满足条件，则视为一次成功转化

### 3. 转化率计算
- 分子：用户有"点击→购买"路径的商品数
- 分母：用户点击过的不同商品总数
- 转化率 = 分子 / 分母

### 4. RDD算子使用策略
- `filter()`: 筛选click和buy行为
- `map()`: 转换数据格式
- `groupByKey()`: 按用户-商品分组
- `reduceByKey()`: 聚合统计
- `join()`: 连接点击和购买数据

### 5. 输出格式
(user_id, conversion_rate)，保留2位小数，无点击行为的用户转化率为0.0

## 实现步骤
1. 读取输入数据
2. 分别过滤出click和buy行为
3. 按用户-商品分组并检查转化条件
4. 计算每个用户的点击商品数和转化商品数
5. 计算转化率并格式化输出